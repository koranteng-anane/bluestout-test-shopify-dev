{% schema %}
{
  "name": "Featured Products"
  "tag": "section",
  "class": "featured-products",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
    },
    {
      "type": "select",
      "id": "heading_tag",
      "label": "Heading Tag",
      "options": [
        { "value": "h1", "label": "H1" },
        { "value": "h2", "label": "H2" }
        { "value": "h3", "label": "H3" }
      ],
      "default": "h2"
    },
    {
      "type": "color"
      "id": "background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "products_count",
      "min": 2,
      "max": 8,
      "step": 1,
      "label": "Number of Products"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Select Collection"
    }
  ],
  "presets": [
    {
      "name": "Featured Products"
    }
  ]
}
{% endschema %}

<div class="featured-products" style="background-color: {{ section.settings.background_color }}">
  <div class="featured-products__container page-width">
    
    <{{ section.settings.heading_tag }} class="featured-products__heading">
      {{ section.settings.heading }}
    </{{ section.settings.heading_tag }}>

    {% if section.settings.collection != blank %}
      <div class="featured-products__grid">
        {% for product in section.settings.collection.products limit: section.settings.products_count %}
          <div class="featured-products__card">
            
            <div 
              class="featured-products__image-link"
              role="link"
              onclick="window.location='{{ product.url }}'"
            >
              <img 
                src="{{ product.featured_image | image_url: width: 600 }}"
                width="600"
                height="600"
                loading="lazy"
              >
            </div>

            <div class="featured-products__info">
              <div class="featured-products__title">{{ product.title }}</div>
              
              <div class="featured-products__price">
                {% if product.compare_at_price > product.price %}
                  <span class="featured-products__price--sale">
                    {{ product.price }}
                  </span>
                  <s>{{ product.compare_at_price }}</s>
                {% else %}
                  {{ product.price }}
                {% endif %}
              </div>

              <div 
                class="featured-products__button"
                role="button"
                tabindex="0"
                onclick="addToCart({{ product.variant.first.id }})"
              >
                Add to Cart
              </div>
            </div>

          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="featured-products__empty">
        No collection selected. Please choose a collection in the theme editor.
      </div>
    {% endif %}

  </div>
</div>

{% stylesheet %}
.featured-products {
  padding: 60px 0;
}

.featured-products__grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 24px;
}

.featured-products__card {
  background: #fff;
  border-radius: 8px;
  overflow: hidden;
}

.featured-products__image-link {
  cursor: pointer;
}

.featured-products__title {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 8px;
}

.featured-products__button {
  background: #1a1a1a;
  color: #fff;
  padding: 12px 24px;
  text-align: center;
  cursor: pointer;
}
{% endstylesheet %}
